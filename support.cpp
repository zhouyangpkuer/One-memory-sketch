#include <stdlib.h> 
// #include <afxtempl.h>
//#include "StdAfx.h"
#include "support.h"
#include <math.h>
#include <stdio.h>
#include "md5.h"

double RandReal(double lo, double hi)
{
	double tmpReal;
	tmpReal = ((double) rand())/((double) RAND_MAX);
	return tmpReal*(hi-lo) + lo;
}

unsigned int RandInt(unsigned int lo, unsigned int hi) // return lo ~ hi
{
	unsigned int t1, t2;
	t1 = rand(); 
	t1 = t1 << 15; 
	t2 = rand();
	if(t1+t2 < 0) {
		printf("\nerror in RandInt");
		exit(0);
	}
	return ((t1+t2)%(hi-lo+1))+lo; 
}

// mean = 1/lambda, variance = 1/lambda^2
double RandExponentialDist(double mean)
{
	double tmp=0.0;
	while (tmp==0.0 || tmp==1.0)
		tmp = RandReal(0.0, 1.0);
	return -log(1-tmp) * mean;
}

/*
unsigned int hash(int id, unsigned int key, int maxKey) { // 0 <= key < maxkey
	char c[1000];
	char *str;
	unsigned int hash, i;

	str =itoa(key, c, 10); 

	unsigned int b    = 378551;
	unsigned int a    = 63689;

	unsigned int BitsInUnsignedInt = (unsigned int)(sizeof(unsigned int) * 8);
    unsigned int ThreeQuarters     = (unsigned int)((BitsInUnsignedInt  * 3) / 4);
	unsigned int OneEighth         = (unsigned int)(BitsInUnsignedInt / 8);
	unsigned int HighBits          = (unsigned int)(0xFFFFFFFF) << (BitsInUnsignedInt - OneEighth);
	unsigned int test              = 0;

	unsigned int x    = 0;

	unsigned int seed = 131; // 31 131 1313 13131 131313 etc..

	switch(id) {
	case 1: // JS Hash Function 
		key += (key << 12);
		key ^= (key >> 22);
		key += (key << 4);
		key ^= (key >> 9);
		key += (key << 10);
		key ^= (key >> 2);
		key += (key << 7);
		key ^= (key >> 12);
		hash=key;
		break;
	case 2: // JS Hash Function 
		hash = 1315423911;
	    for(i = 0; i < strlen(str); i++)
		{
			hash ^= ((hash << 5) + str[i] + (hash >> 2));
		}
	    hash = (hash & 0x7FFFFFFF);
		
//		hash = key % maxKey;
		break;
	case 0: // RS Hash Function
  		hash = 1046527; 
		for(i = 0; i < strlen(str); i++)
		{
		    hash = hash * a + str[i];
		    a = a * b;
		}
	    hash = (hash & 0x7FFFFFFF);
		break;
	case 3: // P. J. Weinberger Hash Function 
		hash = 27644437;
		for(i = 0; i < strlen(str); i++)
		{
			hash = (hash << OneEighth) + str[i];
			if((test = hash & HighBits)  != 0)
				hash = (( hash ^ (test >> ThreeQuarters)) & (~HighBits));
		}
		hash = (hash & 0x7FFFFFFF);
		break;
	case 4: // BKDR Hash Function 
		hash = 1073676287;
		for(i = 0; i < strlen(str); i++)
			hash = (hash * seed) + str[i];
		hash = (hash & 0x7FFFFFFF);
		break;
	case 5: // RS Hash Function 
  		hash = 5381;
		int d;
		while (d = *str++)
            hash = ((hash << 5) + hash) + d; // hash * 33 + c 
	    hash = (hash & 0x7FFFFFFF);
		break;
	case 6: // JS Hash Function with a little modification
		key += (key << 11);
		key ^= (key >> 21);
		key += (key << 3);
		key ^= (key >> 8);
		key += (key << 9);
		key ^= (key >> 1);
		key += (key << 6);
		key ^= (key >> 11);
		hash=key;
		break;
	case 7: // JS Hash Function with a little modification. Change initial values of 7 & 8 & 9
		hash = 27644437;
	    for(i = 0; i < strlen(str); i++)
		{
			hash ^= ((hash << 5) + str[i] + (hash >> 2));
		}
	    hash = (hash & 0x7FFFFFFF);
		break;
	case 8: // P. J. Weinberger Hash Function with different initial value
		hash = 1073676287;
		for(i = 0; i < strlen(str); i++)
		{
			hash = (hash << OneEighth) + str[i];
			if((test = hash & HighBits)  != 0)
				hash = (( hash ^ (test >> ThreeQuarters)) & (~HighBits));
		}
		hash = (hash & 0x7FFFFFFF);
		break;
	case 9: // BKDR Hash Function with different initial value
		hash = 1315423911;
		for(i = 0; i < strlen(str); i++)
			hash = (hash * seed) + str[i];
		hash = (hash & 0x7FFFFFFF);
		break;
	default:
		hash = (key ^ (131*id));
//		printf("error in hash id = %d\n",id);
//		exit(0);
	}

	hash = hash % maxKey;

	return hash;
}
*/

unsigned int hash(int id, unsigned int key, unsigned int maxKey) { // 0 <= key < maxkey
	// prime[30] are real primes. 1024 added later
	unsigned int prime[512+1024]={1500450271, 3267000013, 4093082899, 3628273133, 2860486313, 
		256203221, 236887699, 217645199, 198491329, 179424691, 
		160481219, 141650963, 122949829, 104395303, 86028157, 
		67867979, 49979693, 32452867, 15485867, 198491317,
		999593627, 139054403, 792699101, 785734517, 273081631,
		714723547, 308218681, 653056661, 727112891, 422064359

, 984380991, 1164361327, 1813816658, 962540129, 1806629947, 1620991093, 1968805576, 1813559041, 1099154204, 1438747492, 1250455716, 1646065816, 1792609100, 1064355847, 1170052850, 1150747808, 1287102234, 1903331369, 1401245412, 1929147095, 1153516860, 1291469084, 1764096337, 1800205248, 1399931720, 1021607475, 1659002161, 1515319074, 1851650106, 1509459784, 1244889634, 1407136391, 980997873, 925210423, 1141906151, 1930571710, 1850370226, 1439113824, 1730576356, 1653754713, 1547091875, 1105276201, 975157666, 1288780592, 1690071377, 1449308794, 1507793745, 1951036636, 1353937195, 1768168000, 1203858753, 1942203453, 1401815813, 1617444843, 1608427368, 1720508917, 1972911510, 1822099695, 927349728, 951976426, 1714953465, 1863551814, 1648652646, 1601999304, 908928304, 1158824940, 1654541788, 959770493, 970036380, 1010949474, 1037177031, 1440718779, 1398417031, 1861617197, 995737042, 1732062329, 1695868315, 1215223636, 1256699721, 1494848371, 1806208616, 1897122533, 1386834078, 1368048805, 1079509473, 1656210032, 1703215336, 1496297684, 1128286175, 1691786634, 1633500511, 1802659845, 1838555549, 1893228619, 1967932386, 1858455556, 1273637947, 1045162448, 1340509553, 1424472798, 1617302331, 925743803, 1971085491, 1663042919, 1829688071, 1411435438, 1045814385, 1652598197, 1711344489, 1622406100, 1022759449, 941900195, 1270211089, 1738596184, 1281044540, 1701913936, 1832842514, 1191712235, 1178254608, 1884705181, 1384701285, 1824002370, 1632035055, 1938627250, 1318666597, 979821462, 
929710294, 1457149562, 969897810, 1374940707, 1946839271, 1867127586, 1411856335, 1235986345, 1782925031, 1198820766, 1332961379, 1216410350, 1395963072, 1337704484, 1101153787, 1246954810, 1949012737, 915054766, 1056675686, 1277910233, 1828156249, 1754724221, 1549946840, 1618691997, 1847546656, 958395793, 1502722408, 1801386329, 1461937614, 1915769650, 1935671186, 1188999783, 1019146114, 1289354858, 1576948149, 1328117283, 1462218620, 1367071112, 1731499414, 1457181038, 1481431715, 1610385822, 1084795355, 1127657772, 1779836416, 1611584772, 1914157201, 1349273798, 1420321089, 1500287444, 1939478952, 1037273257, 1285464375, 1948034156, 1877099889, 1647256772, 1766947416, 1622019567, 1853609766, 1743497998, 1125272382, 1752861379, 1712103266, 1902127614, 963286822, 1709588756, 915719845, 1695344402, 1633677426, 1688010576, 1269759954, 1641784649, 1538421544, 1775798953, 1724828336, 1533148072, 1394233200, 1687747991, 1367492204, 1579072440, 1653269530, 1172977235, 934384661, 1002006534, 1668311317, 1092769117, 1776208159, 1598372515, 1676880377, 1948240887, 1197863393, 1233009570, 1161023614, 931986087, 1354572823, 1963714460, 1099742979, 1461542841, 1639227745, 1656579631

, 902289562, 906381055, 906500465, 906855752, 910650378, 911653167, 915338737, 918923773, 921242046, 923034772, 924074962, 924460986, 928766138, 929996248, 931147643, 940934529, 942902883, 944792500, 948000712, 951948909, 954121391, 955615516, 956461019, 961357961, 966757816, 969770935, 970625104, 972775731, 977264678, 980430910, 982685942, 992004186, 1007323105, 1010210146, 1010373132, 1015751492, 1030310960, 1033719349, 1035782987, 1036984625, 1037607761, 1039813292, 1040284544, 1051373464, 1054833014, 1055340235, 1058086306, 1059751140, 1076712343, 1084658057, 1093791155, 1095480946, 1101991611, 1105259803, 1105384363, 1107863371, 1122414232, 1128095624, 1139577401, 1141888373, 1143305521, 1146537391, 1146984905, 1149773926, 1153213749, 1167860538, 1172897751, 1179035930, 1180575780, 1187634806, 1194799529, 1197937831, 1205631707, 1206995187, 1207582827, 1208808765, 1224074232, 1242810573, 1244856817, 1248640878, 1249410513, 1266006209, 1277636871, 1282399422, 1284093407, 1292515846, 1309361384, 1312019618, 1313532882, 1325750291, 1329205122, 1331077624, 1333288562, 1339736258, 1342922916, 1361578247, 1363111969, 1367152140, 1385680495, 1387484314, 1396695914, 1401732008, 1405922573, 1407622044, 1407678047, 1408259293, 1412385554, 1414312878, 1414509548, 1415473642, 1433868717, 1442069811, 1444720629, 1445865685, 1446262222, 1447451563, 1448502859, 1451886431, 1452302995, 1454156078, 1467641972, 1469810936, 1470088654, 1473904816, 1481145931, 1481172079, 

1487804724, 1492584985, 1493002524, 1493800076, 1499086526, 1504399428, 1510892304, 1511003394, 1515526835, 1516844858, 1521695289, 1524815388, 1527092600, 1531661710, 1533671076, 1539984074, 1541830930, 1542023702, 1557161168, 1563370913, 1564790919, 1568435497, 1574092865, 1583303434, 1584702168, 1590595146, 1594985510, 1598223508, 1598674366, 1599898087, 1600678529, 1602667742, 1614986509, 1620724315, 1633395969, 1635032351, 1640437768, 1641000844, 1641713021, 1643078566, 1646405229, 1647273479, 1649010534, 1650353473, 1652541461, 1654058130, 1655452638, 1655578152, 1661945416, 1663895738, 1670358536, 1675609692, 1680549958, 1684116412, 1687596853, 1689327808, 1689545829, 1692264277, 1694711003, 1695275580, 1695807038, 1701319978, 1703489437, 1706328302, 1708814517, 1711972574, 1712153005, 1714089999, 1715179739, 1715389240, 1717276002, 1717789711, 1731316085, 1731795945, 1734918267, 1740561726, 1740615847, 1743273495, 1744945011, 1745208045, 1746315765, 1751140756, 1758120551, 1758642618, 1758847055, 1759640977, 1760953285, 1773097933, 1781961527, 1790012722, 1790519552, 1794995728, 1797480981, 1800214685, 1801492606, 1801555281, 1805737599, 1814185033, 1821243248, 1838522279, 1840457668, 1840895284, 1845189135, 1855184640, 1857893398, 1859432147, 1862873092, 1868229824, 1874859885, 1877947952, 1882742369, 1885594322, 1887411101, 1893078719, 1895799111, 1902708390, 1913116577, 1913119731, 1923160200, 1930261209, 1931136906, 1932377606, 1932606295, 1939258129, 1944376601, 1946151202, 1948551640, 1961299449, 1963499999, 1969322977 // 512 until now
/// 512 until now
,1969323007 ,1969323049 ,1969323079 ,1969323127 ,1969323151 ,1969323157 ,1969323221 ,1969323281 ,1969323283 ,1969323287 ,1969323347 ,1969323353 ,1969323371 ,1969323397 ,1969323407 ,1969323437 ,1969323443 ,1969323449 ,1969323463 ,1969323497 ,1969323511 ,1969323527 ,1969323539 ,1969323583 ,1969323599 ,1969323607 ,1969323611 ,1969323637 ,1969323649 ,1969323683 ,1969323721 ,1969323731 ,1969323739 ,1969323751 ,1969323787 ,1969323803 ,1969323823 ,1969323833 ,1969323857 ,1969323977 ,1969324033 ,1969324039 ,1969324043 ,1969324057 ,1969324067 ,1969324069 ,1969324079 ,1969324117 ,1969324121 ,1969324129 ,1969324153 ,1969324213 ,1969324229 ,1969324237 ,1969324241 ,1969324249 ,1969324261 ,1969324283 ,1969324289 ,1969324309 ,1969324351 ,1969324391 ,1969324411 ,1969324417 ,1969324439 ,1969324451 ,1969324477 ,1969324481 ,1969324493 ,1969324517 ,1969324531 ,1969324573 ,1969324579 ,1969324601 ,1969324619 ,1969324661 ,1969324697 ,1969324717 ,1969324739 ,1969324757 ,1969324759 ,1969324813 ,1969324871 ,1969324921 ,1969324979 ,1969325023 ,1969325027 ,1969325041 ,1969325063 ,1969325077 ,1969325093 ,1969325143 ,1969325191 ,1969325201 ,1969325209 ,1969325219 ,1969325231 ,1969325233 ,1969325257 ,1969325273 ,1969325279 ,1969325287 ,1969325291 ,1969325317 ,1969325341 ,1969325353 ,1969325363 ,1969325387 ,1969325429 ,1969325443 ,1969325447 ,1969325461 ,1969325473 ,1969325483 ,1969325497 ,1969325503 ,1969325507 ,1969325537 ,1969325569 ,1969325621 ,1969325641 ,1969325663 ,1969325749 ,1969325759 ,1969325773 ,1969325779 ,1969325807 ,1969325819 ,1969325857 ,1969325861 ,1969325863 ,1969325923 
,1969325989 ,1969325993 ,1969326011 ,1969326017 ,1969326031 ,1969326049 ,1969326061 ,1969326067 ,1969326071 ,1969326103 ,1969326127 ,1969326137 ,1969326167 ,1969326187 ,1969326239 ,1969326251 ,1969326253 ,1969326311 ,1969326313 ,1969326347 ,1969326413 ,1969326431 ,1969326433 ,1969326479 ,1969326509 ,1969326523 ,1969326559 ,1969326581 ,1969326589 ,1969326613 ,1969326629 ,1969326647 ,1969326659 ,1969326661 ,1969326691 ,1969326703 ,1969326707 ,1969326713 ,1969326757 ,1969326781 ,1969326797 ,1969326803 ,1969326817 ,1969326829 ,1969326847 ,1969326881 ,1969326889 ,1969326899 ,1969326901 ,1969326917 ,1969326967 ,1969326977 ,1969327001 ,1969327013 ,1969327057 ,1969327093 ,1969327123 ,1969327133 ,1969327147 ,1969327153 ,1969327159 ,1969327249 ,1969327253 ,1969327259 ,1969327267 ,1969327279 ,1969327289 ,1969327301 ,1969327309 ,1969327319 ,1969327337 ,1969327357 ,1969327361 ,1969327363 ,1969327387 ,1969327439 ,1969327463 ,1969327469 ,1969327489 ,1969327499 ,1969327511 ,1969327513 ,1969327517 ,1969327537 ,1969327559 ,1969327579 ,1969327649 ,1969327663 ,1969327667 ,1969327673 ,1969327687 ,1969327691 ,1969327697 ,1969327699 ,1969327709 ,1969327729 ,1969327747 ,1969327771 ,1969327799 ,1969327807 ,1969327817 ,1969327823 ,1969327859 ,1969327891 ,1969327897 ,1969327907 ,1969327937 ,1969327939 ,1969327973 ,1969327993 ,1969327999 ,1969328069 ,1969328077 ,1969328089 ,1969328117 ,1969328177 ,1969328237 ,1969328281 ,1969328299 ,1969328303 ,1969328329 ,1969328357 ,1969328363 ,1969328369 ,1969328393 ,1969328407 ,1969328423 ,1969328429 ,1969328443 ,1969328479 ,1969328489 ,1969328497 
,1969328527 ,1969328531 ,1969328551 ,1969328597 ,1969328639 ,1969328651 ,1969328659 ,1969328677 ,1969328693 ,1969328731 ,1969328743 ,1969328759 ,1969328771 ,1969328813 ,1969328869 ,1969328903 ,1969328939 ,1969328953 ,1969328969 ,1969328983 ,1969329031 ,1969329041 ,1969329049 ,1969329067 ,1969329073 ,1969329091 ,1969329121 ,1969329149 ,1969329151 ,1969329163 ,1969329223 ,1969329247 ,1969329251 ,1969329277 ,1969329289 ,1969329319 ,1969329337 ,1969329353 ,1969329367 ,1969329389 ,1969329407 ,1969329431 ,1969329451 ,1969329457 ,1969329491 ,1969329497 ,1969329503 ,1969329511 ,1969329559 ,1969329569 ,1969329601 ,1969329619 ,1969329641 ,1969329643 ,1969329679 ,1969329701 ,1969329721 ,1969329731 ,1969329737 ,1969329743 ,1969329763 ,1969329779 ,1969329787 ,1969329797 ,1969329811 ,1969329829 ,1969329853 ,1969329863 ,1969329889 ,1969329919 ,1969329931 ,1969329949 ,1969329959 ,1969329983 ,1969330001 ,1969330067 ,1969330073 ,1969330117 ,1969330123 ,1969330159 ,1969330193 ,1969330229 ,1969330243 ,1969330247 ,1969330267 ,1969330301 ,1969330339 ,1969330351 ,1969330361 ,1969330367 ,1969330457 ,1969330471 ,1969330481 ,1969330523 ,1969330529 ,1969330537 ,1969330547 ,1969330589 ,1969330591 ,1969330619 ,1969330631 ,1969330651 ,1969330663 ,1969330673 ,1969330697 ,1969330703 ,1969330717 ,1969330721 ,1969330739 ,1969330751 ,1969330757 ,1969330789 ,1969330823 ,1969330841 ,1969330849 ,1969330859 ,1969330877 ,1969330907 ,1969330931 ,1969330939 ,1969330963 ,1969330997 ,1969331029 ,1969331033 ,1969331069 ,1969331099 ,1969331107 ,1969331129 ,1969331167 ,1969331173 ,1969331207 ,1969331233 
,1969331237 ,1969331251 ,1969331257 ,1969331269 ,1969331291 ,1969331359 ,1969331383 ,1969331407 ,1969331411 ,1969331417 ,1969331447 ,1969331453 ,1969331467 ,1969331471 ,1969331489 ,1969331519 ,1969331531 ,1969331563 ,1969331591 ,1969331593 ,1969331647 ,1969331657 ,1969331669 ,1969331713 ,1969331753 ,1969331789 ,1969331801 ,1969331809 ,1969331839 ,1969331851 ,1969331873 ,1969331887 ,1969331929 ,1969331939 ,1969331941 ,1969331963 ,1969331981 ,1969331999 ,1969332073 ,1969332109 ,1969332191 ,1969332199 ,1969332217 ,1969332221 ,1969332229 ,1969332251 ,1969332271 ,1969332283 ,1969332317 ,1969332341 ,1969332353 ,1969332359 ,1969332397 ,1969332433 ,1969332439 ,1969332481 ,1969332517 ,1969332523 ,1969332557 ,1969332559 ,1969332583 ,1969332593 ,1969332641 ,1969332719 ,1969332721 ,1969332731 ,1969332737 ,1969332769 ,1969332793 ,1969332803 ,1969332811 ,1969332817 ,1969332829 ,1969332839 ,1969332931 ,1969332961 ,1969332973 ,1969332983 ,1969333007 ,1969333013 ,1969333027 ,1969333039 ,1969333081 ,1969333097 ,1969333123 ,1969333127 ,1969333133 ,1969333139 ,1969333169 ,1969333183 ,1969333231 ,1969333241 ,1969333271 ,1969333277 ,1969333283 ,1969333309 ,1969333313 ,1969333339 ,1969333343 ,1969333357 ,1969333369 ,1969333381 ,1969333391 ,1969333427 ,1969333433 ,1969333441 ,1969333459 ,1969333463 ,1969333507 ,1969333519 ,1969333523 ,1969333543 ,1969333571 ,1969333573 ,1969333591 ,1969333627 //1024 till now

	}; 

/*	unsigned __int64 prime[512+1024] = {
		962294784235003, 971989568470057, 981684352705087, 991379136940079, 1001073921175103, 1010768705410097, 1020463489645177, 1030158273880231, 1039853058115219, 1049547842350223, 1059242626585259, 1068937410820241, 1078632195055279, 1088326979290301, 1098021763525289, 1107716547760313, 1117411331995297, 1127106116230279, 1136800900465259, 1146495684700309, 1156190468935409, 1165885253170399, 1175580037405447, 1185274821640439, 1194969605875519, 1204664390110499, 1214359174345487, 1224053958580513, 1233748742815573, 1243443527050553, 1253138311285559, 1262833095520547, 1272527879755603, 1282222663990601, 1291917448225799, 1301612232460801, 1311307016695789, 1321001800930787, 1330696585165799, 1340391369400781, 1350086153635783, 1359780937870769, 1369475722105921, 1379170506340901, 1388865290575909, 1398560074810933, 1408254859045963, 1417949643280957, 1427644427516009, 1437339211751017, 1447033995986147, 1456728780221149, 1466423564456131, 1476118348691131, 1485813132926189, 1495507917161179, 1505202701396209, 1514897485631209, 1524592269866219, 1534287054101213, 1543981838336257, 1553676622571239, 1563371406806219, 1573066191041251, 1582760975276233, 1592455759511257, 1602150543746279, 1611845327981293, 1621540112216273, 1631234896451257, 1640929680686243, 1650624464921239, 1660319249156273, 1670014033391299, 1679708817626321, 1689403601861323, 1699098386096329, 1708793170331363, 1718487954566393, 1728182738801423, 
		1737877523036483, 1747572307271513, 1757267091506501, 1766961875741497, 1776656659976543, 1786351444211533, 1796046228446527, 1805741012681509, 1815435796916519, 1825130581151621, 1834825365386609, 1844520149621593, 1854214933856573, 1863909718091623, 1873604502326621, 1883299286561603, 1892994070796603, 1902688855031609, 1912383639266593, 1922078423501617, 1931773207736609, 1941467991971633, 1951162776206629, 1960857560441753, 1970552344676743, 1980247128911741, 1989941913146729, 1999636697381749, 2009331481616743, 2019026265851743, 2028721050086779, 2038415834321771, 2048110618556771, 2057805402791777, 2067500187026777, 2077194971261797, 2086889755496837, 2096584539731833, 2106279323966927, 2115974108201909, 2125668892436951, 2135363676671977, 2145058460907013, 2154753245142079, 2164448029377061, 2174142813612041, 2183837597847083, 2193532382082133,
		2203227166317211, 2212921950552221, 2222616734787227, 2232311519022251, 2242006303257247, 2251701087492323, 2261395871727319, 2271090655962313, 2280785440197353, 2290480224432359, 2300175008667359, 2309869792902401, 2319564577137383, 2329259361372439, 2338954145607449, 2348648929842431, 2358343714077473, 2368038498312457, 2377733282547449, 2387428066782439, 2397122851017443, 2406817635252479, 2416512419487541, 2426207203722521, 2435901987957533, 2445596772192517, 2455291556427509, 2464986340662623, 2474681124897607, 2484375909132599, 2494070693367587, 2503765477602607, 2513460261837599, 2523155046072589, 2532849830307593, 2542544614542613, 2552239398777667, 2561934183012653, 2571628967247647, 2581323751482649, 2591018535717641, 2600713319952623, 2610408104187607, 2620102888422589, 2629797672657569, 2639492456892617, 2649187241127599, 2658882025362617, 2668576809597599, 2678271593832587, 2687966378067577, 2697661162302571, 2707355946537559, 2717050730772577, 2726745515007607, 2736440299242623, 2746135083477749, 2755829867712739, 2765524651947797, 2775219436182779, 2784914220417853, 2794609004652931, 2804303788887943, 2813998573122943, 2823693357357959, 2833388141592973, 2843082925827961, 2852777710062947, 2862472494297971, 2872167278533027, 2881862062768063, 2891556847003051, 2901251631238039, 2910946415473087, 2920641199708079, 2930335983943087, 2940030768178079, 2949725552413117, 2959420336648099, 2969115120883097, 
		2978809905118081, 2988504689353061, 2998199473588049, 3007894257823033, 3017589042058039, 3027283826293021, 3036978610528013, 3046673394763001, 3056368178998039, 3066062963233021, 3075757747468013, 3085452531703027, 3095147315938081, 3104842100173127, 3114536884408181, 3124231668643199, 3133926452878189, 3143621237113183, 3153316021348217, 3163010805583247, 3172705589818279, 3182400374053267, 3192095158288249, 3201789942523229, 3211484726758213, 3221179510993193, 3230874295228231, 3240569079463217, 3250263863698231, 3259958647933327, 3269653432168337, 3279348216403333, 3289043000638399, 3298737784873403, 3308432569108423, 3318127353343417, 3327822137578403, 3337516921813423, 3347211706048423, 3356906490283403, 3366601274518519, 3376296058753529, 3385990842988571, 3395685627223661, 3405380411458789, 3415075195693801, 3424769979928783, 3434464764163781, 3444159548398841, 3453854332633823, 3463549116868807, 3473243901103807, 3482938685338799, 3492633469573903, 3502328253808883, 3512023038043981, 3521717822278969, 3531412606513993, 3541107390748999, 3550802174984017, 3560496959219047, 3570191743454101, 3579886527689081, 3589581311924081, 3599276096159101, 3608970880394107, 3618665664629089, 3628360448864083, 3638055233099123, 3647750017334113, 3657444801569101, 3667139585804087, 3676834370039093, 3686529154274089, 3696223938509077, 3705918722744059, 3715613506979119, 3725308291214113, 3735003075449159, 3744697859684153, 3754392643919149, 3764087428154153, 3773782212389213, 3783476996624207, 3793171780859269, 3802866565094269, 3812561349329281, 3822256133564273,	
		3831950917799293, 3841645702034279, 3851340486269261, 3861035270504249, 3870730054739291, 3880424838974297, 3890119623209311, 3899814407444353, 3909509191679387, 3919203975914371, 3928898760149371, 3938593544384383, 3948288328619381, 3957983112854363, 3967677897089441, 3977372681324431, 3987067465559461, 3996762249794443, 4006457034029473, 4016151818264459, 4025846602499453, 4035541386734447, 4045236170969431, 4054930955204429, 4064625739439429, 4074320523674413, 4084015307909417, 4093710092144423, 4103404876379461, 4113099660614453, 4122794444849441, 4132489229084453, 4142184013319501, 4151878797554497, 4161573581789509, 4171268366024503, 4180963150259501, 4190657934494509, 4200352718729537, 4210047502964573, 4219742287199563, 4229437071434579, 4239131855669653, 4248826639904663, 4258521424139651, 4268216208374639, 4277910992609623, 4287605776844623, 4297300561079623, 4306995345314617, 4316690129549659, 4326384913784639, 4336079698019623, 4345774482254609, 4355469266489651, 4365164050724647, 4374858834959653, 4384553619194633, 4394248403429671, 4403943187664677, 4413637971899773, 4423332756134833, 4433027540369977, 4442722324604981, 4452417108840031, 4462111893075019, 4471806677310017, 4481501461545019, 4491196245780007, 4500891030014989, 4510585814250011, 4520280598485013, 
		4529975382720019, 4539670166955067, 4549364951190091, 4559059735425119, 4568754519660109, 4578449303895193, 4588144088130247, 4597838872365307, 4607533656600293, 4617228440835289, 4626923225070271, 4636618009305259, 4646312793540251, 4656007577775251, 4665702362010253, 4675397146245307, 4685091930480287, 4694786714715277, 4704481498950271, 4714176283185251, 4723871067420233, 4733565851655233, 4743260635890223, 4752955420125221, 4762650204360241, 4772344988595253, 4782039772830241, 4791734557065229, 4801429341300227, 4811124125535269, 4820818909770277, 4830513694005281, 4840208478240329, 4849903262475329, 4859598046710317, 4869292830945311, 4878987615180317, 4888682399415307, 4898377183650289, 4908071967885367, 4917766752120353, 4927461536355493, 4937156320590493, 4946851104825503, 4956545889060503, 4966240673295611, 4975935457530601, 4985630241765629, 4995325026000619, 5005019810235623, 5014714594470611, 5024409378705659, 5034104162940649, 5043798947175629, 5053493731410667, 5063188515645649, 5072883299880631, 5082578084115613, 5092272868350671, 5101967652585701, 5111662436820739, 5121357221055799, 5131052005290793, 5140746789525779, 5150441573760761, 5160136357995793, 5169831142230779, 5179525926465799, 5189220710700797, 5198915494935817, 5208610279170869, 5218305063405869, 5227999847640893, 5237694631875907, 5247389416111019, 5257084200346057, 5266778984581069, 5276473768816049, 5286168553051033, 5295863337286013, 5305558121521037, 5315252905756033, 5324947689991031, 5334642474226033, 5344337258461049, 5354032042696049, 5363726826931069, 5373421611166093, 5383116395401081, 5392811179636061, 5402505963871061, 5412200748106121, 5421895532341129, 5431590316576139, 5441285100811141, 5450979885046121,	
		5460674669281133, 5470369453516147, 5480064237751141, 5489759021986199, 5499453806221231, 5509148590456213, 5518843374691193, 5528538158926177, 5538232943161231, 5547927727396211, 5557622511631219, 5567317295866211, 5577012080101199, 5586706864336187, 5596401648571177, 5606096432806159, 5615791217041139, 5625486001276147, 5635180785511127, 5644875569746109, 5654570353981127, 5664265138216123, 5673959922451133, 5683654706686153, 5693349490921133, 5703044275156139, 5712739059391153, 5722433843626177, 5732128627861183, 5741823412096223, 5751518196331217, 5761212980566231, 5770907764801219, 5780602549036229, 5790297333271229, 5799992117506271, 5809686901741271, 5819381685976267, 5829076470211277, 5838771254446261, 5848466038681243, 5858160822916261, 5867855607151303, 5877550391386301, 5887245175621283, 5896939959856277, 5906634744091339, 5916329528326331, 5926024312561313, 5935719096796327, 5945413881031343, 5955108665266339, 5964803449501331, 5974498233736313, 5984193017971319, 5993887802206307, 6003582586441291, 6013277370676271, 6022972154911333, 6032666939146333, 6042361723381409, 6052056507616397, 6061751291851379, 6071446076086367, 6081140860321379, 6090835644556363, 6100530428791363, 6110225213026387, 6119919997261457, 6129614781496463, 6139309565731457, 6149004349966469, 6158699134201507, 6168393918436501, 6178088702671489, 6187783486906519, 6197478271141567, 6207173055376567, 6216867839611579, 6226562623846583, 6236257408081609, 6245952192316649, 6255646976551657, 6265341760786639, 6275036545021627, 6284731329256621, 6294426113491603, 6304120897726657, 6313815681961651, 6323510466196631, 6333205250431669, 6342900034666687, 6352594818901687, 6362289603136667, 6371984387371651, 6381679171606703, 6391373955841859, 6401068740076849, 6410763524311837, 6420458308546819, 6430153092781829, 6439847877016837, 6449542661251853, 6459237445486853, 6468932229721847, 6478627013956873, 6488321798191979, 6498016582426961, 6507711366661951, 6517406150896999, 6527100935131991, 6536795719367029,	
		6546490503602039, 6556185287837161, 6565880072072149, 6575574856307147, 6585269640542237, 6594964424777233, 6604659209012237, 6614353993247243, 6624048777482233, 6633743561717227, 6643438345952249, 6653133130187261, 6662827914422261, 6672522698657281, 6682217482892267, 6691912267127293, 6701607051362291, 6711301835597311, 6720996619832291, 6730691404067369, 6740386188302381, 6750080972537377, 6759775756772383, 6769470541007371, 6779165325242413, 6788860109477393, 6798554893712459, 6808249677947447, 6817944462182543, 6827639246417531, 6837334030652539, 6847028814887533, 6856723599122531, 6866418383357543, 6876113167592533, 6885807951827543, 6895502736062533, 6905197520297551, 6914892304532549, 6924587088767567, 6934281873002557, 6943976657237549, 6953671441472531, 6963366225707519, 6973061009942507, 6982755794177509, 6992450578412513, 7002145362647509, 7011840146882609, 7021534931117633, 7031229715352651, 7040924499587663, 7050619283822659, 7060314068057671, 7070008852292671, 7079703636527651, 7089398420762641, 7099093204997723, 7108787989232711, 7118482773467759, 7128177557702741, 7137872341937789, 7147567126172771, 7157261910407771, 7166956694642761, 7176651478877791, 7186346263112879, 7196041047347881, 7205735831582863, 7215430615817911, 7225125400052891, 7234820184287933, 7244514968522957, 7254209752757951, 7263904536993053, 7273599321228059, 7283294105463073, 7292988889698077, 7302683673933101, 7312378458168107, 7322073242403097, 7331768026638101, 7341462810873101, 7351157595108133, 7360852379343157, 7370547163578149, 7380241947813181, 7389936732048163, 7399631516283143, 7409326300518133, 7419021084753133, 7428715868988119, 7438410653223167, 7448105437458181, 7457800221693167, 7467495005928151,	
		7477189790163139, 7486884574398227, 7496579358633227, 7506274142868217, 7515968927103199, 7525663711338229, 7535358495573217, 7545053279808217, 7554748064043203, 7564442848278193, 7574137632513203, 7583832416748229, 7593527200983221, 7603221985218217, 7612916769453197, 7622611553688217, 7632306337923227, 7642001122158253, 7651695906393257, 7661390690628253, 7671085474863299, 7680780259098313, 7690475043333293, 7700169827568331, 7709864611803313, 7719559396038313, 7729254180273313, 7738948964508299, 7748643748743281, 7758338532978281, 7768033317213287, 7777728101448323, 7787422885683307, 7797117669918331, 7806812454153329, 7816507238388383, 7826202022623371, 7835896806858371, 7845591591093397, 7855286375328499, 7864981159563523, 7874675943798529, 7884370728033581, 7894065512268589, 7903760296503569, 7913455080738737, 7923149864973787, 7932844649208803, 7942539433443793, 7952234217678823, 7961929001913851, 7971623786148941, 7981318570383929, 7991013354618949, 8000708138853949, 8010402923088959, 8020097707323967, 8029792491558973, 8039487275793989, 8049182060029049, 8058876844264109, 8068571628499229, 8078266412734253, 8087961196969337, 8097655981204417, 8107350765439439, 8117045549674507, 8126740333909513, 8136435118144519, 8146129902379501, 8155824686614547, 8165519470849537, 8175214255084571, 8184909039319559, 8194603823554567, 8204298607789549, 8213993392024543, 8223688176259531, 8233382960494511, 8243077744729507, 8252772528964571, 8262467313199609, 8272162097434597, 8281856881669649, 8291551665904631, 8301246450139627, 8310941234374607, 8320636018609631, 8330330802844627, 8340025587079649, 8349720371314633, 8359415155549651, 8369109939784663, 8378804724019687, 8388499508254699, 8398194292489741,
		8407889076724751, 8417583860959751, 8427278645194753, 8436973429429733, 8446668213664729, 8456362997899757, 8466057782134781, 8475752566369789, 8485447350604787, 8495142134839771, 8504836919074787, 8514531703309781, 8524226487544787, 8533921271779769, 8543616056014759, 8553310840249759, 8563005624484807, 8572700408719789, 8582395192954819, 8592089977189799, 8601784761424787, 8611479545659807, 8621174329894811, 8630869114129909, 8640563898364961, 8650258682599991, 8659953466835003, 8669648251069987, 8679343035305011, 8689037819539997, 8698732603775003, 8708427388010003, 8718122172245009, 8727816956480009, 8737511740715129, 8747206524950177, 8756901309185179, 8766596093420213, 8776290877655237, 8785985661890363, 8795680446125359, 8805375230360369, 8815070014595443, 8824764798830473, 8834459583065503, 8844154367300501, 8853849151535503, 8863543935770497, 8873238720005477, 8882933504240461, 8892628288475461, 8902323072710447, 8912017856945443, 8921712641180429, 8931407425415437, 8941102209650449, 8950796993885447, 8960491778120459, 8970186562355477, 8979881346590507, 8989576130825497, 8999270915060479, 9008965699295483, 9018660483530561, 9028355267765549, 9038050052000573, 9047744836235593, 9057439620470581, 9067134404705567, 9076829188940561, 9086523973175573, 9096218757410557, 9105913541645539, 9115608325880533, 9125303110115609, 9134997894350591, 9144692678585599, 9154387462820581, 9164082247055569, 9173777031290549, 9183471815525593, 9193166599760603, 9202861383995627, 9212556168230609, 9222250952465767, 9231945736700747, 9241640520935737, 9251335305170767, 9261030089405833, 9270724873640861, 9280419657875881, 9290114442110863, 9299809226345857, 9309504010580857, 9319198794815891, 9328893579050873,
		9338588363285869, 9348283147520873, 9357977931755863, 9367672715990843, 9377367500225849, 9387062284460843, 9396757068695933, 9406451852931013, 9416146637166001, 9425841421400981, 9435536205636001, 9445230989870981, 9454925774105969, 9464620558340953, 9474315342575939, 9484010126810939, 9493704911045933, 9503399695280941, 9513094479515953, 9522789263750969, 9532484047985989, 9542178832221023, 9551873616456007, 9561568400691077, 9571263184926167, 9580957969161169, 9590652753396181, 9600347537631181, 9610042321866193, 9619737106101277, 9629431890336283, 9639126674571269, 9648821458806287, 9658516243041269, 9668211027276259, 9677905811511247, 9687600595746247, 9697295379981359, 9706990164216343, 9716684948451419, 9726379732686403, 9736074516921407, 9745769301156419, 9755464085391439, 9765158869626431, 9774853653861419, 9784548438096409, 9794243222331427, 9803938006566551, 9813632790801557, 9823327575036539, 9833022359271547, 9842717143506553, 9852411927741553, 9862106711976641, 9871801496211631, 9881496280446619, 9891191064681673, 9900885848916653, 9910580633151683, 9920275417386673, 9929970201621661, 9939664985856649, 9949359770091649, 9959054554326697, 9968749338561709, 9978444122796689, 9988138907031749, 9997833691266761, 10007528475501749, 10017223259736841, 10026918043971821,
		10036612828206827, 10046307612441811, 10056002396676857, 10065697180911871, 10075391965146941, 10085086749381949, 10094781533616929, 10104476317851911, 10114171102086899, 10123865886321883, 10133560670556889, 10143255454791869, 10152950239026851, 10162645023261911, 10172339807496941, 10182034591732021, 10191729375967039, 10201424160202019, 10211118944437181, 10220813728672181, 10230508512907273, 10240203297142309, 10249898081377303, 10259592865612297, 10269287649847297, 10278982434082289, 10288677218317339, 10298372002552343, 10308066786787327, 10317761571022307, 10327456355257303, 10337151139492369, 10346845923727349, 10356540707962373, 10366235492197547, 10375930276432529, 10385625060667561, 10395319844902541, 10405014629137571, 10414709413372571, 10424404197607553, 10434098981842567, 10443793766077613, 10453488550312609, 10463183334547637, 10472878118782631, 10482572903017667, 10492267687252667, 10501962471487649, 10511657255722673, 10521352039957657, 10531046824192669, 10540741608427661, 10550436392662667, 10560131176897699, 10569825961132817, 10579520745367837, 10589215529602817, 10598910313837817, 10608605098072801, 10618299882307787, 10627994666542949, 10637689450777931, 10647384235013063, 10657079019248089, 10666773803483159, 10676468587718189, 10686163371953197, 10695858156188197, 10705552940423189, 10715247724658227, 10724942508893233, 10734637293128249, 10744332077363321, 10754026861598353, 10763721645833341, 10773416430068381, 10783111214303369, 10792805998538371, 10802500782773353, 10812195567008347, 10821890351243327, 10831585135478357, 10841279919713359, 10850974703948339, 10860669488183327, 10870364272418353, 10880059056653333 
	}; //1024 primes so far*/
	char c[100];
	char *str;
	unsigned char uc[100], output[100];
	unsigned char *ustr;
	unsigned int hash=0, part[4]={0,0,0,0};
	int i,j;
 
	key = key ^ prime[id-1];
	key = key + id;
	sprintf(c,"%d",key);
	str = c;
	// str =itoa(key, c, 10);
	ustr=uc;
	i=0;
	while(str[i]!=NULL) {
		ustr[i]=(unsigned char) str[i];
		i++;
	}
	ustr[i]=NULL;
	md5(uc,i,output);

	for(i=0;i<4;i++) 
		for(j=4*i;j<4*i+4;j++) 
			part[i] = part[i] ^ output[j];
	hash = (part[0] << 24) + (part[1] << 16) + (part[2] << 8) + part[3];

//	for(i=0;i<4;i++) {  //first 4 bytes, speedy but more collision
//		hash = hash << 8;
//		hash = hash ^ (unsigned int) output[i];
//	}
	hash = hash % maxKey;
	return hash;
}


unsigned int hash2(int id, unsigned int key1, unsigned int key2, unsigned int maxKey) { // 0 <= key < maxkey
	// prime[30] are real primes. 1024 added later
	unsigned int prime[512+1024]={1500450271, 3267000013, 4093082899, 3628273133, 2860486313, 
		256203221, 236887699, 217645199, 198491329, 179424691, 
		160481219, 141650963, 122949829, 104395303, 86028157, 
		67867979, 49979693, 32452867, 15485867, 198491317,
		999593627, 139054403, 792699101, 785734517, 273081631,
		714723547, 308218681, 653056661, 727112891, 422064359

, 984380991, 1164361327, 1813816658, 962540129, 1806629947, 1620991093, 1968805576, 1813559041, 1099154204, 1438747492, 1250455716, 1646065816, 1792609100, 1064355847, 1170052850, 1150747808, 1287102234, 1903331369, 1401245412, 1929147095, 1153516860, 1291469084, 1764096337, 1800205248, 1399931720, 1021607475, 1659002161, 1515319074, 1851650106, 1509459784, 1244889634, 1407136391, 980997873, 925210423, 1141906151, 1930571710, 1850370226, 1439113824, 1730576356, 1653754713, 1547091875, 1105276201, 975157666, 1288780592, 1690071377, 1449308794, 1507793745, 1951036636, 1353937195, 1768168000, 1203858753, 1942203453, 1401815813, 1617444843, 1608427368, 1720508917, 1972911510, 1822099695, 927349728, 951976426, 1714953465, 1863551814, 1648652646, 1601999304, 908928304, 1158824940, 1654541788, 959770493, 970036380, 1010949474, 1037177031, 1440718779, 1398417031, 1861617197, 995737042, 1732062329, 1695868315, 1215223636, 1256699721, 1494848371, 1806208616, 1897122533, 1386834078, 1368048805, 1079509473, 1656210032, 1703215336, 1496297684, 1128286175, 1691786634, 1633500511, 1802659845, 1838555549, 1893228619, 1967932386, 1858455556, 1273637947, 1045162448, 1340509553, 1424472798, 1617302331, 925743803, 1971085491, 1663042919, 1829688071, 1411435438, 1045814385, 1652598197, 1711344489, 1622406100, 1022759449, 941900195, 1270211089, 1738596184, 1281044540, 1701913936, 1832842514, 1191712235, 1178254608, 1884705181, 1384701285, 1824002370, 1632035055, 1938627250, 1318666597, 979821462, 
929710294, 1457149562, 969897810, 1374940707, 1946839271, 1867127586, 1411856335, 1235986345, 1782925031, 1198820766, 1332961379, 1216410350, 1395963072, 1337704484, 1101153787, 1246954810, 1949012737, 915054766, 1056675686, 1277910233, 1828156249, 1754724221, 1549946840, 1618691997, 1847546656, 958395793, 1502722408, 1801386329, 1461937614, 1915769650, 1935671186, 1188999783, 1019146114, 1289354858, 1576948149, 1328117283, 1462218620, 1367071112, 1731499414, 1457181038, 1481431715, 1610385822, 1084795355, 1127657772, 1779836416, 1611584772, 1914157201, 1349273798, 1420321089, 1500287444, 1939478952, 1037273257, 1285464375, 1948034156, 1877099889, 1647256772, 1766947416, 1622019567, 1853609766, 1743497998, 1125272382, 1752861379, 1712103266, 1902127614, 963286822, 1709588756, 915719845, 1695344402, 1633677426, 1688010576, 1269759954, 1641784649, 1538421544, 1775798953, 1724828336, 1533148072, 1394233200, 1687747991, 1367492204, 1579072440, 1653269530, 1172977235, 934384661, 1002006534, 1668311317, 1092769117, 1776208159, 1598372515, 1676880377, 1948240887, 1197863393, 1233009570, 1161023614, 931986087, 1354572823, 1963714460, 1099742979, 1461542841, 1639227745, 1656579631

, 902289562, 906381055, 906500465, 906855752, 910650378, 911653167, 915338737, 918923773, 921242046, 923034772, 924074962, 924460986, 928766138, 929996248, 931147643, 940934529, 942902883, 944792500, 948000712, 951948909, 954121391, 955615516, 956461019, 961357961, 966757816, 969770935, 970625104, 972775731, 977264678, 980430910, 982685942, 992004186, 1007323105, 1010210146, 1010373132, 1015751492, 1030310960, 1033719349, 1035782987, 1036984625, 1037607761, 1039813292, 1040284544, 1051373464, 1054833014, 1055340235, 1058086306, 1059751140, 1076712343, 1084658057, 1093791155, 1095480946, 1101991611, 1105259803, 1105384363, 1107863371, 1122414232, 1128095624, 1139577401, 1141888373, 1143305521, 1146537391, 1146984905, 1149773926, 1153213749, 1167860538, 1172897751, 1179035930, 1180575780, 1187634806, 1194799529, 1197937831, 1205631707, 1206995187, 1207582827, 1208808765, 1224074232, 1242810573, 1244856817, 1248640878, 1249410513, 1266006209, 1277636871, 1282399422, 1284093407, 1292515846, 1309361384, 1312019618, 1313532882, 1325750291, 1329205122, 1331077624, 1333288562, 1339736258, 1342922916, 1361578247, 1363111969, 1367152140, 1385680495, 1387484314, 1396695914, 1401732008, 1405922573, 1407622044, 1407678047, 1408259293, 1412385554, 1414312878, 1414509548, 1415473642, 1433868717, 1442069811, 1444720629, 1445865685, 1446262222, 1447451563, 1448502859, 1451886431, 1452302995, 1454156078, 1467641972, 1469810936, 1470088654, 1473904816, 1481145931, 1481172079, 

1487804724, 1492584985, 1493002524, 1493800076, 1499086526, 1504399428, 1510892304, 1511003394, 1515526835, 1516844858, 1521695289, 1524815388, 1527092600, 1531661710, 1533671076, 1539984074, 1541830930, 1542023702, 1557161168, 1563370913, 1564790919, 1568435497, 1574092865, 1583303434, 1584702168, 1590595146, 1594985510, 1598223508, 1598674366, 1599898087, 1600678529, 1602667742, 1614986509, 1620724315, 1633395969, 1635032351, 1640437768, 1641000844, 1641713021, 1643078566, 1646405229, 1647273479, 1649010534, 1650353473, 1652541461, 1654058130, 1655452638, 1655578152, 1661945416, 1663895738, 1670358536, 1675609692, 1680549958, 1684116412, 1687596853, 1689327808, 1689545829, 1692264277, 1694711003, 1695275580, 1695807038, 1701319978, 1703489437, 1706328302, 1708814517, 1711972574, 1712153005, 1714089999, 1715179739, 1715389240, 1717276002, 1717789711, 1731316085, 1731795945, 1734918267, 1740561726, 1740615847, 1743273495, 1744945011, 1745208045, 1746315765, 1751140756, 1758120551, 1758642618, 1758847055, 1759640977, 1760953285, 1773097933, 1781961527, 1790012722, 1790519552, 1794995728, 1797480981, 1800214685, 1801492606, 1801555281, 1805737599, 1814185033, 1821243248, 1838522279, 1840457668, 1840895284, 1845189135, 1855184640, 1857893398, 1859432147, 1862873092, 1868229824, 1874859885, 1877947952, 1882742369, 1885594322, 1887411101, 1893078719, 1895799111, 1902708390, 1913116577, 1913119731, 1923160200, 1930261209, 1931136906, 1932377606, 1932606295, 1939258129, 1944376601, 1946151202, 1948551640, 1961299449, 1963499999, 1969322977 // 512 until now
/// 512 until now
,1969323007 ,1969323049 ,1969323079 ,1969323127 ,1969323151 ,1969323157 ,1969323221 ,1969323281 ,1969323283 ,1969323287 ,1969323347 ,1969323353 ,1969323371 ,1969323397 ,1969323407 ,1969323437 ,1969323443 ,1969323449 ,1969323463 ,1969323497 ,1969323511 ,1969323527 ,1969323539 ,1969323583 ,1969323599 ,1969323607 ,1969323611 ,1969323637 ,1969323649 ,1969323683 ,1969323721 ,1969323731 ,1969323739 ,1969323751 ,1969323787 ,1969323803 ,1969323823 ,1969323833 ,1969323857 ,1969323977 ,1969324033 ,1969324039 ,1969324043 ,1969324057 ,1969324067 ,1969324069 ,1969324079 ,1969324117 ,1969324121 ,1969324129 ,1969324153 ,1969324213 ,1969324229 ,1969324237 ,1969324241 ,1969324249 ,1969324261 ,1969324283 ,1969324289 ,1969324309 ,1969324351 ,1969324391 ,1969324411 ,1969324417 ,1969324439 ,1969324451 ,1969324477 ,1969324481 ,1969324493 ,1969324517 ,1969324531 ,1969324573 ,1969324579 ,1969324601 ,1969324619 ,1969324661 ,1969324697 ,1969324717 ,1969324739 ,1969324757 ,1969324759 ,1969324813 ,1969324871 ,1969324921 ,1969324979 ,1969325023 ,1969325027 ,1969325041 ,1969325063 ,1969325077 ,1969325093 ,1969325143 ,1969325191 ,1969325201 ,1969325209 ,1969325219 ,1969325231 ,1969325233 ,1969325257 ,1969325273 ,1969325279 ,1969325287 ,1969325291 ,1969325317 ,1969325341 ,1969325353 ,1969325363 ,1969325387 ,1969325429 ,1969325443 ,1969325447 ,1969325461 ,1969325473 ,1969325483 ,1969325497 ,1969325503 ,1969325507 ,1969325537 ,1969325569 ,1969325621 ,1969325641 ,1969325663 ,1969325749 ,1969325759 ,1969325773 ,1969325779 ,1969325807 ,1969325819 ,1969325857 ,1969325861 ,1969325863 ,1969325923 
,1969325989 ,1969325993 ,1969326011 ,1969326017 ,1969326031 ,1969326049 ,1969326061 ,1969326067 ,1969326071 ,1969326103 ,1969326127 ,1969326137 ,1969326167 ,1969326187 ,1969326239 ,1969326251 ,1969326253 ,1969326311 ,1969326313 ,1969326347 ,1969326413 ,1969326431 ,1969326433 ,1969326479 ,1969326509 ,1969326523 ,1969326559 ,1969326581 ,1969326589 ,1969326613 ,1969326629 ,1969326647 ,1969326659 ,1969326661 ,1969326691 ,1969326703 ,1969326707 ,1969326713 ,1969326757 ,1969326781 ,1969326797 ,1969326803 ,1969326817 ,1969326829 ,1969326847 ,1969326881 ,1969326889 ,1969326899 ,1969326901 ,1969326917 ,1969326967 ,1969326977 ,1969327001 ,1969327013 ,1969327057 ,1969327093 ,1969327123 ,1969327133 ,1969327147 ,1969327153 ,1969327159 ,1969327249 ,1969327253 ,1969327259 ,1969327267 ,1969327279 ,1969327289 ,1969327301 ,1969327309 ,1969327319 ,1969327337 ,1969327357 ,1969327361 ,1969327363 ,1969327387 ,1969327439 ,1969327463 ,1969327469 ,1969327489 ,1969327499 ,1969327511 ,1969327513 ,1969327517 ,1969327537 ,1969327559 ,1969327579 ,1969327649 ,1969327663 ,1969327667 ,1969327673 ,1969327687 ,1969327691 ,1969327697 ,1969327699 ,1969327709 ,1969327729 ,1969327747 ,1969327771 ,1969327799 ,1969327807 ,1969327817 ,1969327823 ,1969327859 ,1969327891 ,1969327897 ,1969327907 ,1969327937 ,1969327939 ,1969327973 ,1969327993 ,1969327999 ,1969328069 ,1969328077 ,1969328089 ,1969328117 ,1969328177 ,1969328237 ,1969328281 ,1969328299 ,1969328303 ,1969328329 ,1969328357 ,1969328363 ,1969328369 ,1969328393 ,1969328407 ,1969328423 ,1969328429 ,1969328443 ,1969328479 ,1969328489 ,1969328497 
,1969328527 ,1969328531 ,1969328551 ,1969328597 ,1969328639 ,1969328651 ,1969328659 ,1969328677 ,1969328693 ,1969328731 ,1969328743 ,1969328759 ,1969328771 ,1969328813 ,1969328869 ,1969328903 ,1969328939 ,1969328953 ,1969328969 ,1969328983 ,1969329031 ,1969329041 ,1969329049 ,1969329067 ,1969329073 ,1969329091 ,1969329121 ,1969329149 ,1969329151 ,1969329163 ,1969329223 ,1969329247 ,1969329251 ,1969329277 ,1969329289 ,1969329319 ,1969329337 ,1969329353 ,1969329367 ,1969329389 ,1969329407 ,1969329431 ,1969329451 ,1969329457 ,1969329491 ,1969329497 ,1969329503 ,1969329511 ,1969329559 ,1969329569 ,1969329601 ,1969329619 ,1969329641 ,1969329643 ,1969329679 ,1969329701 ,1969329721 ,1969329731 ,1969329737 ,1969329743 ,1969329763 ,1969329779 ,1969329787 ,1969329797 ,1969329811 ,1969329829 ,1969329853 ,1969329863 ,1969329889 ,1969329919 ,1969329931 ,1969329949 ,1969329959 ,1969329983 ,1969330001 ,1969330067 ,1969330073 ,1969330117 ,1969330123 ,1969330159 ,1969330193 ,1969330229 ,1969330243 ,1969330247 ,1969330267 ,1969330301 ,1969330339 ,1969330351 ,1969330361 ,1969330367 ,1969330457 ,1969330471 ,1969330481 ,1969330523 ,1969330529 ,1969330537 ,1969330547 ,1969330589 ,1969330591 ,1969330619 ,1969330631 ,1969330651 ,1969330663 ,1969330673 ,1969330697 ,1969330703 ,1969330717 ,1969330721 ,1969330739 ,1969330751 ,1969330757 ,1969330789 ,1969330823 ,1969330841 ,1969330849 ,1969330859 ,1969330877 ,1969330907 ,1969330931 ,1969330939 ,1969330963 ,1969330997 ,1969331029 ,1969331033 ,1969331069 ,1969331099 ,1969331107 ,1969331129 ,1969331167 ,1969331173 ,1969331207 ,1969331233 
,1969331237 ,1969331251 ,1969331257 ,1969331269 ,1969331291 ,1969331359 ,1969331383 ,1969331407 ,1969331411 ,1969331417 ,1969331447 ,1969331453 ,1969331467 ,1969331471 ,1969331489 ,1969331519 ,1969331531 ,1969331563 ,1969331591 ,1969331593 ,1969331647 ,1969331657 ,1969331669 ,1969331713 ,1969331753 ,1969331789 ,1969331801 ,1969331809 ,1969331839 ,1969331851 ,1969331873 ,1969331887 ,1969331929 ,1969331939 ,1969331941 ,1969331963 ,1969331981 ,1969331999 ,1969332073 ,1969332109 ,1969332191 ,1969332199 ,1969332217 ,1969332221 ,1969332229 ,1969332251 ,1969332271 ,1969332283 ,1969332317 ,1969332341 ,1969332353 ,1969332359 ,1969332397 ,1969332433 ,1969332439 ,1969332481 ,1969332517 ,1969332523 ,1969332557 ,1969332559 ,1969332583 ,1969332593 ,1969332641 ,1969332719 ,1969332721 ,1969332731 ,1969332737 ,1969332769 ,1969332793 ,1969332803 ,1969332811 ,1969332817 ,1969332829 ,1969332839 ,1969332931 ,1969332961 ,1969332973 ,1969332983 ,1969333007 ,1969333013 ,1969333027 ,1969333039 ,1969333081 ,1969333097 ,1969333123 ,1969333127 ,1969333133 ,1969333139 ,1969333169 ,1969333183 ,1969333231 ,1969333241 ,1969333271 ,1969333277 ,1969333283 ,1969333309 ,1969333313 ,1969333339 ,1969333343 ,1969333357 ,1969333369 ,1969333381 ,1969333391 ,1969333427 ,1969333433 ,1969333441 ,1969333459 ,1969333463 ,1969333507 ,1969333519 ,1969333523 ,1969333543 ,1969333571 ,1969333573 ,1969333591 ,1969333627 //1024 till now

	}; 

/*	unsigned __int64 prime[512+1024] = {
		962294784235003, 971989568470057, 981684352705087, 991379136940079, 1001073921175103, 1010768705410097, 1020463489645177, 1030158273880231, 1039853058115219, 1049547842350223, 1059242626585259, 1068937410820241, 1078632195055279, 1088326979290301, 1098021763525289, 1107716547760313, 1117411331995297, 1127106116230279, 1136800900465259, 1146495684700309, 1156190468935409, 1165885253170399, 1175580037405447, 1185274821640439, 1194969605875519, 1204664390110499, 1214359174345487, 1224053958580513, 1233748742815573, 1243443527050553, 1253138311285559, 1262833095520547, 1272527879755603, 1282222663990601, 1291917448225799, 1301612232460801, 1311307016695789, 1321001800930787, 1330696585165799, 1340391369400781, 1350086153635783, 1359780937870769, 1369475722105921, 1379170506340901, 1388865290575909, 1398560074810933, 1408254859045963, 1417949643280957, 1427644427516009, 1437339211751017, 1447033995986147, 1456728780221149, 1466423564456131, 1476118348691131, 1485813132926189, 1495507917161179, 1505202701396209, 1514897485631209, 1524592269866219, 1534287054101213, 1543981838336257, 1553676622571239, 1563371406806219, 1573066191041251, 1582760975276233, 1592455759511257, 1602150543746279, 1611845327981293, 1621540112216273, 1631234896451257, 1640929680686243, 1650624464921239, 1660319249156273, 1670014033391299, 1679708817626321, 1689403601861323, 1699098386096329, 1708793170331363, 1718487954566393, 1728182738801423, 
		1737877523036483, 1747572307271513, 1757267091506501, 1766961875741497, 1776656659976543, 1786351444211533, 1796046228446527, 1805741012681509, 1815435796916519, 1825130581151621, 1834825365386609, 1844520149621593, 1854214933856573, 1863909718091623, 1873604502326621, 1883299286561603, 1892994070796603, 1902688855031609, 1912383639266593, 1922078423501617, 1931773207736609, 1941467991971633, 1951162776206629, 1960857560441753, 1970552344676743, 1980247128911741, 1989941913146729, 1999636697381749, 2009331481616743, 2019026265851743, 2028721050086779, 2038415834321771, 2048110618556771, 2057805402791777, 2067500187026777, 2077194971261797, 2086889755496837, 2096584539731833, 2106279323966927, 2115974108201909, 2125668892436951, 2135363676671977, 2145058460907013, 2154753245142079, 2164448029377061, 2174142813612041, 2183837597847083, 2193532382082133,
		2203227166317211, 2212921950552221, 2222616734787227, 2232311519022251, 2242006303257247, 2251701087492323, 2261395871727319, 2271090655962313, 2280785440197353, 2290480224432359, 2300175008667359, 2309869792902401, 2319564577137383, 2329259361372439, 2338954145607449, 2348648929842431, 2358343714077473, 2368038498312457, 2377733282547449, 2387428066782439, 2397122851017443, 2406817635252479, 2416512419487541, 2426207203722521, 2435901987957533, 2445596772192517, 2455291556427509, 2464986340662623, 2474681124897607, 2484375909132599, 2494070693367587, 2503765477602607, 2513460261837599, 2523155046072589, 2532849830307593, 2542544614542613, 2552239398777667, 2561934183012653, 2571628967247647, 2581323751482649, 2591018535717641, 2600713319952623, 2610408104187607, 2620102888422589, 2629797672657569, 2639492456892617, 2649187241127599, 2658882025362617, 2668576809597599, 2678271593832587, 2687966378067577, 2697661162302571, 2707355946537559, 2717050730772577, 2726745515007607, 2736440299242623, 2746135083477749, 2755829867712739, 2765524651947797, 2775219436182779, 2784914220417853, 2794609004652931, 2804303788887943, 2813998573122943, 2823693357357959, 2833388141592973, 2843082925827961, 2852777710062947, 2862472494297971, 2872167278533027, 2881862062768063, 2891556847003051, 2901251631238039, 2910946415473087, 2920641199708079, 2930335983943087, 2940030768178079, 2949725552413117, 2959420336648099, 2969115120883097, 
		2978809905118081, 2988504689353061, 2998199473588049, 3007894257823033, 3017589042058039, 3027283826293021, 3036978610528013, 3046673394763001, 3056368178998039, 3066062963233021, 3075757747468013, 3085452531703027, 3095147315938081, 3104842100173127, 3114536884408181, 3124231668643199, 3133926452878189, 3143621237113183, 3153316021348217, 3163010805583247, 3172705589818279, 3182400374053267, 3192095158288249, 3201789942523229, 3211484726758213, 3221179510993193, 3230874295228231, 3240569079463217, 3250263863698231, 3259958647933327, 3269653432168337, 3279348216403333, 3289043000638399, 3298737784873403, 3308432569108423, 3318127353343417, 3327822137578403, 3337516921813423, 3347211706048423, 3356906490283403, 3366601274518519, 3376296058753529, 3385990842988571, 3395685627223661, 3405380411458789, 3415075195693801, 3424769979928783, 3434464764163781, 3444159548398841, 3453854332633823, 3463549116868807, 3473243901103807, 3482938685338799, 3492633469573903, 3502328253808883, 3512023038043981, 3521717822278969, 3531412606513993, 3541107390748999, 3550802174984017, 3560496959219047, 3570191743454101, 3579886527689081, 3589581311924081, 3599276096159101, 3608970880394107, 3618665664629089, 3628360448864083, 3638055233099123, 3647750017334113, 3657444801569101, 3667139585804087, 3676834370039093, 3686529154274089, 3696223938509077, 3705918722744059, 3715613506979119, 3725308291214113, 3735003075449159, 3744697859684153, 3754392643919149, 3764087428154153, 3773782212389213, 3783476996624207, 3793171780859269, 3802866565094269, 3812561349329281, 3822256133564273,	
		3831950917799293, 3841645702034279, 3851340486269261, 3861035270504249, 3870730054739291, 3880424838974297, 3890119623209311, 3899814407444353, 3909509191679387, 3919203975914371, 3928898760149371, 3938593544384383, 3948288328619381, 3957983112854363, 3967677897089441, 3977372681324431, 3987067465559461, 3996762249794443, 4006457034029473, 4016151818264459, 4025846602499453, 4035541386734447, 4045236170969431, 4054930955204429, 4064625739439429, 4074320523674413, 4084015307909417, 4093710092144423, 4103404876379461, 4113099660614453, 4122794444849441, 4132489229084453, 4142184013319501, 4151878797554497, 4161573581789509, 4171268366024503, 4180963150259501, 4190657934494509, 4200352718729537, 4210047502964573, 4219742287199563, 4229437071434579, 4239131855669653, 4248826639904663, 4258521424139651, 4268216208374639, 4277910992609623, 4287605776844623, 4297300561079623, 4306995345314617, 4316690129549659, 4326384913784639, 4336079698019623, 4345774482254609, 4355469266489651, 4365164050724647, 4374858834959653, 4384553619194633, 4394248403429671, 4403943187664677, 4413637971899773, 4423332756134833, 4433027540369977, 4442722324604981, 4452417108840031, 4462111893075019, 4471806677310017, 4481501461545019, 4491196245780007, 4500891030014989, 4510585814250011, 4520280598485013, 
		4529975382720019, 4539670166955067, 4549364951190091, 4559059735425119, 4568754519660109, 4578449303895193, 4588144088130247, 4597838872365307, 4607533656600293, 4617228440835289, 4626923225070271, 4636618009305259, 4646312793540251, 4656007577775251, 4665702362010253, 4675397146245307, 4685091930480287, 4694786714715277, 4704481498950271, 4714176283185251, 4723871067420233, 4733565851655233, 4743260635890223, 4752955420125221, 4762650204360241, 4772344988595253, 4782039772830241, 4791734557065229, 4801429341300227, 4811124125535269, 4820818909770277, 4830513694005281, 4840208478240329, 4849903262475329, 4859598046710317, 4869292830945311, 4878987615180317, 4888682399415307, 4898377183650289, 4908071967885367, 4917766752120353, 4927461536355493, 4937156320590493, 4946851104825503, 4956545889060503, 4966240673295611, 4975935457530601, 4985630241765629, 4995325026000619, 5005019810235623, 5014714594470611, 5024409378705659, 5034104162940649, 5043798947175629, 5053493731410667, 5063188515645649, 5072883299880631, 5082578084115613, 5092272868350671, 5101967652585701, 5111662436820739, 5121357221055799, 5131052005290793, 5140746789525779, 5150441573760761, 5160136357995793, 5169831142230779, 5179525926465799, 5189220710700797, 5198915494935817, 5208610279170869, 5218305063405869, 5227999847640893, 5237694631875907, 5247389416111019, 5257084200346057, 5266778984581069, 5276473768816049, 5286168553051033, 5295863337286013, 5305558121521037, 5315252905756033, 5324947689991031, 5334642474226033, 5344337258461049, 5354032042696049, 5363726826931069, 5373421611166093, 5383116395401081, 5392811179636061, 5402505963871061, 5412200748106121, 5421895532341129, 5431590316576139, 5441285100811141, 5450979885046121,	
		5460674669281133, 5470369453516147, 5480064237751141, 5489759021986199, 5499453806221231, 5509148590456213, 5518843374691193, 5528538158926177, 5538232943161231, 5547927727396211, 5557622511631219, 5567317295866211, 5577012080101199, 5586706864336187, 5596401648571177, 5606096432806159, 5615791217041139, 5625486001276147, 5635180785511127, 5644875569746109, 5654570353981127, 5664265138216123, 5673959922451133, 5683654706686153, 5693349490921133, 5703044275156139, 5712739059391153, 5722433843626177, 5732128627861183, 5741823412096223, 5751518196331217, 5761212980566231, 5770907764801219, 5780602549036229, 5790297333271229, 5799992117506271, 5809686901741271, 5819381685976267, 5829076470211277, 5838771254446261, 5848466038681243, 5858160822916261, 5867855607151303, 5877550391386301, 5887245175621283, 5896939959856277, 5906634744091339, 5916329528326331, 5926024312561313, 5935719096796327, 5945413881031343, 5955108665266339, 5964803449501331, 5974498233736313, 5984193017971319, 5993887802206307, 6003582586441291, 6013277370676271, 6022972154911333, 6032666939146333, 6042361723381409, 6052056507616397, 6061751291851379, 6071446076086367, 6081140860321379, 6090835644556363, 6100530428791363, 6110225213026387, 6119919997261457, 6129614781496463, 6139309565731457, 6149004349966469, 6158699134201507, 6168393918436501, 6178088702671489, 6187783486906519, 6197478271141567, 6207173055376567, 6216867839611579, 6226562623846583, 6236257408081609, 6245952192316649, 6255646976551657, 6265341760786639, 6275036545021627, 6284731329256621, 6294426113491603, 6304120897726657, 6313815681961651, 6323510466196631, 6333205250431669, 6342900034666687, 6352594818901687, 6362289603136667, 6371984387371651, 6381679171606703, 6391373955841859, 6401068740076849, 6410763524311837, 6420458308546819, 6430153092781829, 6439847877016837, 6449542661251853, 6459237445486853, 6468932229721847, 6478627013956873, 6488321798191979, 6498016582426961, 6507711366661951, 6517406150896999, 6527100935131991, 6536795719367029,	
		6546490503602039, 6556185287837161, 6565880072072149, 6575574856307147, 6585269640542237, 6594964424777233, 6604659209012237, 6614353993247243, 6624048777482233, 6633743561717227, 6643438345952249, 6653133130187261, 6662827914422261, 6672522698657281, 6682217482892267, 6691912267127293, 6701607051362291, 6711301835597311, 6720996619832291, 6730691404067369, 6740386188302381, 6750080972537377, 6759775756772383, 6769470541007371, 6779165325242413, 6788860109477393, 6798554893712459, 6808249677947447, 6817944462182543, 6827639246417531, 6837334030652539, 6847028814887533, 6856723599122531, 6866418383357543, 6876113167592533, 6885807951827543, 6895502736062533, 6905197520297551, 6914892304532549, 6924587088767567, 6934281873002557, 6943976657237549, 6953671441472531, 6963366225707519, 6973061009942507, 6982755794177509, 6992450578412513, 7002145362647509, 7011840146882609, 7021534931117633, 7031229715352651, 7040924499587663, 7050619283822659, 7060314068057671, 7070008852292671, 7079703636527651, 7089398420762641, 7099093204997723, 7108787989232711, 7118482773467759, 7128177557702741, 7137872341937789, 7147567126172771, 7157261910407771, 7166956694642761, 7176651478877791, 7186346263112879, 7196041047347881, 7205735831582863, 7215430615817911, 7225125400052891, 7234820184287933, 7244514968522957, 7254209752757951, 7263904536993053, 7273599321228059, 7283294105463073, 7292988889698077, 7302683673933101, 7312378458168107, 7322073242403097, 7331768026638101, 7341462810873101, 7351157595108133, 7360852379343157, 7370547163578149, 7380241947813181, 7389936732048163, 7399631516283143, 7409326300518133, 7419021084753133, 7428715868988119, 7438410653223167, 7448105437458181, 7457800221693167, 7467495005928151,	
		7477189790163139, 7486884574398227, 7496579358633227, 7506274142868217, 7515968927103199, 7525663711338229, 7535358495573217, 7545053279808217, 7554748064043203, 7564442848278193, 7574137632513203, 7583832416748229, 7593527200983221, 7603221985218217, 7612916769453197, 7622611553688217, 7632306337923227, 7642001122158253, 7651695906393257, 7661390690628253, 7671085474863299, 7680780259098313, 7690475043333293, 7700169827568331, 7709864611803313, 7719559396038313, 7729254180273313, 7738948964508299, 7748643748743281, 7758338532978281, 7768033317213287, 7777728101448323, 7787422885683307, 7797117669918331, 7806812454153329, 7816507238388383, 7826202022623371, 7835896806858371, 7845591591093397, 7855286375328499, 7864981159563523, 7874675943798529, 7884370728033581, 7894065512268589, 7903760296503569, 7913455080738737, 7923149864973787, 7932844649208803, 7942539433443793, 7952234217678823, 7961929001913851, 7971623786148941, 7981318570383929, 7991013354618949, 8000708138853949, 8010402923088959, 8020097707323967, 8029792491558973, 8039487275793989, 8049182060029049, 8058876844264109, 8068571628499229, 8078266412734253, 8087961196969337, 8097655981204417, 8107350765439439, 8117045549674507, 8126740333909513, 8136435118144519, 8146129902379501, 8155824686614547, 8165519470849537, 8175214255084571, 8184909039319559, 8194603823554567, 8204298607789549, 8213993392024543, 8223688176259531, 8233382960494511, 8243077744729507, 8252772528964571, 8262467313199609, 8272162097434597, 8281856881669649, 8291551665904631, 8301246450139627, 8310941234374607, 8320636018609631, 8330330802844627, 8340025587079649, 8349720371314633, 8359415155549651, 8369109939784663, 8378804724019687, 8388499508254699, 8398194292489741,
		8407889076724751, 8417583860959751, 8427278645194753, 8436973429429733, 8446668213664729, 8456362997899757, 8466057782134781, 8475752566369789, 8485447350604787, 8495142134839771, 8504836919074787, 8514531703309781, 8524226487544787, 8533921271779769, 8543616056014759, 8553310840249759, 8563005624484807, 8572700408719789, 8582395192954819, 8592089977189799, 8601784761424787, 8611479545659807, 8621174329894811, 8630869114129909, 8640563898364961, 8650258682599991, 8659953466835003, 8669648251069987, 8679343035305011, 8689037819539997, 8698732603775003, 8708427388010003, 8718122172245009, 8727816956480009, 8737511740715129, 8747206524950177, 8756901309185179, 8766596093420213, 8776290877655237, 8785985661890363, 8795680446125359, 8805375230360369, 8815070014595443, 8824764798830473, 8834459583065503, 8844154367300501, 8853849151535503, 8863543935770497, 8873238720005477, 8882933504240461, 8892628288475461, 8902323072710447, 8912017856945443, 8921712641180429, 8931407425415437, 8941102209650449, 8950796993885447, 8960491778120459, 8970186562355477, 8979881346590507, 8989576130825497, 8999270915060479, 9008965699295483, 9018660483530561, 9028355267765549, 9038050052000573, 9047744836235593, 9057439620470581, 9067134404705567, 9076829188940561, 9086523973175573, 9096218757410557, 9105913541645539, 9115608325880533, 9125303110115609, 9134997894350591, 9144692678585599, 9154387462820581, 9164082247055569, 9173777031290549, 9183471815525593, 9193166599760603, 9202861383995627, 9212556168230609, 9222250952465767, 9231945736700747, 9241640520935737, 9251335305170767, 9261030089405833, 9270724873640861, 9280419657875881, 9290114442110863, 9299809226345857, 9309504010580857, 9319198794815891, 9328893579050873,
		9338588363285869, 9348283147520873, 9357977931755863, 9367672715990843, 9377367500225849, 9387062284460843, 9396757068695933, 9406451852931013, 9416146637166001, 9425841421400981, 9435536205636001, 9445230989870981, 9454925774105969, 9464620558340953, 9474315342575939, 9484010126810939, 9493704911045933, 9503399695280941, 9513094479515953, 9522789263750969, 9532484047985989, 9542178832221023, 9551873616456007, 9561568400691077, 9571263184926167, 9580957969161169, 9590652753396181, 9600347537631181, 9610042321866193, 9619737106101277, 9629431890336283, 9639126674571269, 9648821458806287, 9658516243041269, 9668211027276259, 9677905811511247, 9687600595746247, 9697295379981359, 9706990164216343, 9716684948451419, 9726379732686403, 9736074516921407, 9745769301156419, 9755464085391439, 9765158869626431, 9774853653861419, 9784548438096409, 9794243222331427, 9803938006566551, 9813632790801557, 9823327575036539, 9833022359271547, 9842717143506553, 9852411927741553, 9862106711976641, 9871801496211631, 9881496280446619, 9891191064681673, 9900885848916653, 9910580633151683, 9920275417386673, 9929970201621661, 9939664985856649, 9949359770091649, 9959054554326697, 9968749338561709, 9978444122796689, 9988138907031749, 9997833691266761, 10007528475501749, 10017223259736841, 10026918043971821,
		10036612828206827, 10046307612441811, 10056002396676857, 10065697180911871, 10075391965146941, 10085086749381949, 10094781533616929, 10104476317851911, 10114171102086899, 10123865886321883, 10133560670556889, 10143255454791869, 10152950239026851, 10162645023261911, 10172339807496941, 10182034591732021, 10191729375967039, 10201424160202019, 10211118944437181, 10220813728672181, 10230508512907273, 10240203297142309, 10249898081377303, 10259592865612297, 10269287649847297, 10278982434082289, 10288677218317339, 10298372002552343, 10308066786787327, 10317761571022307, 10327456355257303, 10337151139492369, 10346845923727349, 10356540707962373, 10366235492197547, 10375930276432529, 10385625060667561, 10395319844902541, 10405014629137571, 10414709413372571, 10424404197607553, 10434098981842567, 10443793766077613, 10453488550312609, 10463183334547637, 10472878118782631, 10482572903017667, 10492267687252667, 10501962471487649, 10511657255722673, 10521352039957657, 10531046824192669, 10540741608427661, 10550436392662667, 10560131176897699, 10569825961132817, 10579520745367837, 10589215529602817, 10598910313837817, 10608605098072801, 10618299882307787, 10627994666542949, 10637689450777931, 10647384235013063, 10657079019248089, 10666773803483159, 10676468587718189, 10686163371953197, 10695858156188197, 10705552940423189, 10715247724658227, 10724942508893233, 10734637293128249, 10744332077363321, 10754026861598353, 10763721645833341, 10773416430068381, 10783111214303369, 10792805998538371, 10802500782773353, 10812195567008347, 10821890351243327, 10831585135478357, 10841279919713359, 10850974703948339, 10860669488183327, 10870364272418353, 10880059056653333 
	}; //1024 primes so far*/
	char c[100];
	char *str1, *str2;
	unsigned char uc1[100], uc2[100], uc[100], output1[100], output2[100], output[100];;
	unsigned char *ustr1, *ustr2;
	unsigned int hash=0, part[4]={0,0,0,0};
	int i,j;
	
	key1 = key1 ^ prime[id-1];
	key1 = key1 + id;
	sprintf(c,"%d",key1);
	str1 = c;
	// str1 = itoa(key1, c, 10);
	ustr1 = uc1;
	i=0;
	while(str1[i]!=NULL) {
		ustr1[i]=(unsigned char) str1[i];
		i++;
	}
	ustr1[i]=NULL;
	md5(uc1, i, output1);


	key2 = key2 ^ prime[1024-id];
	key2 = key2 + id;
	// str2 = itoa(key2, c, 10);
	sprintf(c,"%d",key2);
	str2 = c;
	ustr2 = uc2;
	i=0;
	while(str2[i]!=NULL) {
		ustr2[i]=(unsigned char) str2[i];
		i++;
	}
	ustr2[i]=NULL;
	md5(uc2, i, output2);
	

/*	char c[100];
	char *str;
	unsigned char 
	unsigned char *ustr;
	unsigned int hash=0, part[4]={0,0,0,0};
	int i,j;
 
	key1 = key1 ^ prime[id-1];
	key1 = key1 + id;
	str =itoa(key1, c, 10);
	md5(uc,i,output1);
	ustr=uc;
	i=0;
	while(str[i]!=NULL) {
		ustr[i]=(unsigned char) str[i];
		i++;
	}
	ustr[i]=NULL;
	
	key2 = key2 ^ prime[id-1];
	key2 = key2 + id;
	str =itoa(key2, c, 10);
	md5(uc,i,output2);*/

	for (i = 0; i < 16; i++)
	{	
		output[i] = output1[15-i] ^ output2[i];
	}


	for(i=0;i<4;i++) 
		for(j=4*i;j<4*i+4;j++) 
			part[i] = part[i] ^ output[j];
	hash = (part[0] << 24) + (part[1] << 16) + (part[2] << 8) + part[3];

//	for(i=0;i<4;i++) {  //first 4 bytes, speedy but more collision
//		hash = hash << 8;
//		hash = hash ^ (unsigned int) output[i];
//	}
	hash = hash % maxKey;
	return hash;
}

/*unsigned hash(int id, int key, int maxKey) { // 0 <= key < maxkey
	int hash;

	hash = (key+131*id) % maxKey;
	//hash = (key) % maxKey;
	return hash;
} */

/*unsigned int hash(int id, unsigned int key, int maxKey) { // 0 <= key < maxkey
	char c[1000];
	char a[1000];
	int input, bits;
	unsigned int hash;

	input = key ^ (131*id);
//	input = pow(2,31)+pow(2,30);
	itoa(input, a, 16);
//	int t = atoi(a);
//	hash = (unsigned int) t;

	strcpy(c,MD5String(a));
	c[6]=NULL;

//	printf(" c=%s",c);
	bits=(int) log(maxKey)/log(2.0);
	hash=strtol(c,NULL,16);
	hash = hash % maxKey;

	return hash;
}
 */


// FILETIME TimeSubstraction(FILETIME time1, FILETIME time2)
// {
// 	FILETIME result;

//     // we assume that time1 >= time2 
// 	Assert((time1.dwHighDateTime == time2.dwHighDateTime && time1.dwLowDateTime >= time2.dwLowDateTime) 
// 		   || time1.dwHighDateTime > time2.dwHighDateTime, 
// 		   "An assumption fails");

// 	result.dwHighDateTime = time1.dwHighDateTime - time2.dwHighDateTime;
// 	if (time1.dwLowDateTime < time2.dwLowDateTime)
// 	{
// 		result.dwHighDateTime --;
// 		result.dwLowDateTime = time2.dwLowDateTime - time1.dwLowDateTime;
// 		result.dwLowDateTime = 0xffffffff - result.dwLowDateTime;
// 		result.dwLowDateTime ++;
// 	}
// 	else
// 	{
// 		result.dwLowDateTime = time1.dwLowDateTime - time2.dwLowDateTime;
// 	}

// 	return result;
// }

// FILETIME TimeAddition(FILETIME time1, FILETIME time2)
// {
// 	FILETIME result;
// 	DWORD tmp;

// 	result.dwHighDateTime = time1.dwHighDateTime + time2.dwHighDateTime;
// 	if (time1.dwLowDateTime == 0)
// 	{
// 		result.dwLowDateTime =  time2.dwLowDateTime;
// 	}
// 	else
// 	{
// 		tmp = 0xffffffff - time1.dwLowDateTime;
// 		if (tmp < time2.dwLowDateTime)
// 		{
// 			result.dwHighDateTime ++;
// 			result.dwLowDateTime = time2.dwLowDateTime - tmp - 1;
// 		}
// 		else
// 		{
// 			result.dwLowDateTime = time1.dwLowDateTime + time2.dwLowDateTime;
// 		}
// 	}

// 	return result;
// }

/*int min(int a, int b)
{
	if (a<b)
		return a;
	else 
		return b;
} */

// void Assert(bool condition, CString msg)
// {
// 	if (!condition)
// 	{
// 		printf("%s\n", msg);
// 		exit(1);
// 	}
// }

// void AddSet(CArray<int, int> &S, int a) {
// 	for(int i=0;i<S.GetSize();i++) 
// 		if (S[i] == a)
// 			return;
// 	S.Add(a);
// }

// bool InSet(CArray<int, int> &S, int a) {
// 	for(int i=0;i<S.GetSize();i++) 
// 		if (S[i] == a)
// 			return true;
// 	return false;
// }


/*int zipf(int x) { //return a value 0 <= <=x-1 by zipf distribution
	int i;
	double r,c,denominator;

	denominator=0;
	for(i=1; i <= x ;i++) 
		denominator += 1.0/(double)i;
	r=RandInt(0,1000000)/double(1000000);
	c=0.0;
	for(i=1;i <= x ;i++) {
		c += (1.0/i) / denominator;
		if (r <= c)
			return (i-1); 
	}
	printf("\nerror in zipf");
	exit(0);
}
*/

Zipf::Zipf(int seed) {  // initialize Zipf.
	unsigned int i, j, index, cardinality[100000];
	size=0;
	index=1;
	for(i=1;i<=seed;i++) {
		cardinality[i]=256/i;
		size += cardinality[i];
//		printf("%d, ",cardinality[i]);
		for(j=1;j<=cardinality[i];j++) {
			arr[index++]=i;
		}
	}
//	printf(" size=%d",size);
//	printf("\narr[]\n");
//	for(j=1;j<=size;j++) 
//		printf(" %d",arr[j]);
}

unsigned int Zipf::generate() { // return random number to Zipf distribution
	unsigned int r;
//	r=RandInt(1,size);
	return arr[r];
}